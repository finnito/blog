{{ partial "header.html" . }}

<div class="content">
    {{ .Content }}

    <label class="filter-button" for="sport">
        <input name="filter" type="radio" id="sport" checked>üèÉ Sport üèî</label>
    <label class="filter-button" for="other">
        <input name="filter" type="radio" id="other">üíª Other üßë‚Äçüíª</label>

    <script>
        document.addEventListener("DOMContentLoaded", doFilter);
        document.querySelectorAll("input[name='filter']").forEach(function(el) {
            el.addEventListener("click", doFilter);
        });

        function doFilter() {
            var categories = ["sport", "hiking", "cycling", "trail-running"];
            var filter = document.querySelector("input[name='filter']:checked").id;

            var hasSportCategory = false;
            document.querySelectorAll("ul.archive > ul").forEach(function(list) {

                visible = 0;
                list.querySelectorAll("li").forEach(function(post) {
                    categories.forEach(function(category) {
                        if (post.classList.contains(category)) {
                            hasSportCategory = true;
                        }
                    });

                    if (filter == "sport") {
                        if (hasSportCategory) {
                            post.classList.remove("hidden");
                            visible += 1;
                        } else {
                            post.classList.add("hidden");
                        }
                    } else {
                        if (hasSportCategory) {
                            post.classList.add("hidden");
                        } else {
                            visible += 1;
                            post.classList.remove("hidden");
                        }
                    }

                    hasSportCategory = false;
                    if (visible == 0) {
                        list.classList.add("hidden");
                    } else {
                        list.classList.remove("hidden");
                    }
                });
            });
        }
    </script>

    <ul class="archive">
        <!-- Ranges through content/posts/*.md -->
        {{ $pages := (where .Site.RegularPages "Section" "posts") }}
        {{ range $pages.GroupByDate "January 2006" "desc" }}
            <ul>
            <p>{{ .Key }}</p>    
            {{ range .Pages }}
                {{ if (isset .Params.categories 0) }}
                    <li class="{{ lower (index .Params.categories 0) }}">
                {{ else }}
                    <li>
                {{ end }}
                    {{ if (.Draft) }}<strong>DRAFT: </strong>{{ end }}<a href="{{.Permalink}}">{{.Title}} <time>{{ .PublishDate.Format "2 Jan 2006" }}</time></a>
                </li>
            {{ end }}
            </ul>
        {{ end }}
    </ul>
</div>

{{ partial "footer.html" . }}
